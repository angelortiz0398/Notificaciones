using AdministracionSGD.Services.Api.Controllers.Common;
using Microsoft.AspNetCore.Mvc;
using Notificaciones.Modelo.Entidades.Notificaciones;
using Notificaciones.Negocio.Negocios.Notificaciones;
using Shared.Modelos;

namespace FHL_SGD_Notificaciones_Api.Controllers
{
    /// <summary>
    /// Controlador para la manipulacion de notificaciones atraves de Twilio
    /// </summary>
    [ApiController]
    [Route("[controller]")]
    public class EnvioNotificacionController : Controller
    {
        private EnvioViajeBusiness _bss { get; set; } = new();

        /// <summary>
        /// Crea una notificacion usando Twilio por los medios que se le especifican por la request.
        /// Ademas, crea un registro en la tabla historica de alertas 
        /// </summary>
        /// <param name="request"></param>
        /// <returns>Retorna una Respuesta, dependiendo si fue exitosa tendra estatus 200 (Exitoso) o 500 (Error del servidor, tanto de la base de datos o de Twilio) </returns>
        /// <example> 
        /// <value>
        /// {"Id":1,"CategoriasNotificacionesId":1,"Nombre":"Custodio asignado","Activada":true,"Condiciones":"{\"notificaciones\":[{\"notificacion\":\"email\"},{\"notificacion\":\"user\"},{\"notificacion\":\"push\"}]}","ListaContactos":"[{\"emails\":[{\"email\":\"prueba@prueba.com\"}],\"phones\":[{\"phone\":\"5584935123\"}],\"users\":[{\"userId\":22}]}]","Reglas":"{\"Aplazamiento\":{\"Intervalo\":\"00:00:30\",\"Repeticiones\":5,\"RepeticionActual\":5,\"UltimaEjecucion\":\"2024-02-17T17:22:43.0930378-06:00\"}}\r\n","Usuario":"usrPhoenixAdmin","Eliminado":true,"FechaCreacion":"2023-09-12T16:38:47.160","Trail":"[{\"trail_system_user\":\"Phoenix\",\"trail_workstation\":\"DESKTOP-47BG2KH\",\"trail_notes\":\"Alta de registro\",\"trail_timemark\":\"2023-09-12T16:38:47.16\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-12T17:12:08.3224143-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-12T17:13:19.7335516-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:49:01.2718846-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:49:50.8339963-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:50:08.6502493-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:58:23.1207184-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:59:37.0392048-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T14:59:37.0392048-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T15:00:22.3557453-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T15:00:32.8436329-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T15:00:32.8436329-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T15:00:53.5421834-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T15:01:20.9854258-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T16:50:54.5593523-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T16:50:54.5593523-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-13T19:20:58.5046045-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-14T12:22:56.5490185-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-14T12:23:34.2993454-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-15T18:43:10.9266943-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-15T18:44:45.0984229-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T13:07:27.4212363-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T13:26:58.9572547-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T13:34:42.6109293-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T13:41:07.5960665-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T14:21:44.352036-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T14:40:00.3816832-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T14:40:00.3816832-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T14:49:42.5237057-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-19T16:50:34.0369543-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-26T18:11:26.2862253-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-26T18:11:26.2862253-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:55:34.1105813-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:55:34.1105813-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:55:34.1105813-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:55:34.1105813-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:59:38.1704106-06:00\"},{\"trail_system_user\":\"roter\",\"trail_workstation\":\"PHOENIX-A\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-09-27T10:59:38.1704106-06:00\"},{\"trail_system_user\":\"pep.desarrollo\",\"trail_workstation\":\"LAPTOP-KMD9MDO4\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2023-10-17T13:13:06.8425013-06:00\"},{\"trail_system_user\":\"erick\",\"trail_workstation\":\"NEWLAND-ERICK\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2024-01-29T17:11:30.1260573-06:00\"},{\"trail_system_user\":\"angel\",\"trail_workstation\":\"PHOENIX\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2024-02-13T17:38:05.5557604-06:00\"},{\"trail_system_user\":\"angel\",\"trail_workstation\":\"PHOENIX\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2024-02-13T17:38:05.5557604-06:00\"},{\"trail_system_user\":\"angel\",\"trail_workstation\":\"PHOENIX\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2024-02-15T10:47:55.9172465-06:00\"},{\"trail_system_user\":\"angel\",\"trail_workstation\":\"PHOENIX\",\"trail_notes\":\"Actualización de registro\",\"trail_timemark\":\"2024-02-15T16:44:40.433102-06:00\"}]"}
        /// </value>
        /// </example>
        [HttpPost("CreacionNotificacion")]
        public Respuesta CreacionNotificacion(Notificacion request)
        {
            return _bss.CreacionNotificacion(request);
        }
    }
}
